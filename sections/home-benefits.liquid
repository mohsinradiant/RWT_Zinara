<section class="home-benefits-container-parent">
  <div class="page-width section_heading_with_button">
    <h2 class="section-heading">{{ section.settings.heading }}</h2>
    {% comment %} <p>View All</p> {% endcomment %}
  </div>
  <div class="home-benefits-container">
    {% for block in section.blocks %}
      <div class="zinara-benefits-content" id="{{ block.id }}">
        <img src="{{ block.settings.image | img_url: 'medium' }}" alt="{{ block.settings.text }}">
        <p>{{ block.settings.text }}</p>
      </div>
    {% endfor %}
  </div>
</section>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const isProductsPage = document.body.classList.contains('template-product');
    const viewportWidth = window.innerWidth;

    if (!isProductsPage && viewportWidth > 756) {
      const benefitsContainer = document.querySelector('.home-benefits-container');

      // Make sure images are fully loaded before cloning and animating
      const images = benefitsContainer.querySelectorAll('img');
      let loadedImages = 0;

      if (images.length === 0) {
        startAnimation();
      } else {
        images.forEach((img) => {
          if (img.complete) {
            loadedImages++;
            if (loadedImages === images.length) startAnimation();
          } else {
            img.addEventListener('load', () => {
              loadedImages++;
              if (loadedImages === images.length) startAnimation();
            });
            img.addEventListener('error', () => {
              loadedImages++;
              if (loadedImages === images.length) startAnimation();
            });
          }
        });
      }

      function startAnimation() {
        const blocks = benefitsContainer.innerHTML;
        benefitsContainer.innerHTML += blocks;

        const totalWidth = benefitsContainer.scrollWidth / 2;

        gsap.to('.home-benefits-container', {
          x: `-${totalWidth}px`,
          ease: 'none',
          duration: 30, // Adjust duration for speed
          repeat: -1,
        });
      }
    }
  });
</script>
<style>
  .home-benefits-container {
    display: flex;
    gap: 20px; /* Ensures consistent spacing between items */
    align-items: center;
    width: 100%; /* Full width for the scrolling container */
  }

  .zinara-benefits-content {
    min-width: 180px; /* Ensures each block takes up 17% of the container width */
    width: 180px; /* Ensures each block takes up 17% of the container width */
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
  }

  .zinara-benefits-content img {
    width: 35%;
    height: auto;
    aspect-ratio: 1/1;
    display: block;
    border-radius: 0; /* Keeps image styling consistent */
  }

  .zinara-benefits-content p {
    margin-top: 10px; /* Simplifies margin shorthand */
    font-weight: 600;
    line-height: 2rem;
    font-size: 1.2rem;
    letter-spacing: 0;
  }

  .section_heading_with_button {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .home-benefits-container-parent {
    overflow: hidden; /* Hides overflow for seamless scrolling */
    margin-top: 50px;
  }

  .section_heading_with_button p {
    color: #610c27;
    text-decoration: underline;
    cursor: pointer;
  }

  @media (max-width: 756px) {
    .zinara-benefits-content {
      width: 100px;
      min-width: 100px;
    }

    .zinara-benefits-content img {
      width: 50%; /* Larger image size for better visibility on mobile */
    }

    .zinara-benefits-content p {
      font-size: 1rem; /* Slightly smaller text for better fit */
    }

    .section_heading_with_button {
      flex-direction: column; /* Adjust layout for smaller screens */
      align-items: flex-start;
    }
  }
</style>
{% if template == 'product' %}
  <style>
    .zinara-benefits-content {
      min-width: fit-content !important;
      margin: 15px 15px 0;
    }
  </style>
{% endif %}
{% schema %}
{
  "name": "Zinara Benefits",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Section Heading",
      "default": "Zinara Benefits"
    }
  ],
  "blocks": [
    {
      "type": "tab",
      "name": "Category Tab",
      "settings": [
        {
          "type": "text",
          "id": "text",
          "label": "Text",
          "default": "Occasion"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Zinara Benefits"
    }
  ]
}
{% endschema %}
